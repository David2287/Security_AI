# Security_AI
![Логотип проекта](ai-hub-svgrepo-com.svg)

## Цель работы:

Обеспечение информационной безопасности в компьютерной сети за счет использования алгоритмов машинного обучения.

## Содержание

- [Описание](#описание)
- [Библиотеки](#библиотеки)
- [Данные](#данные)
- [Использование](#использование)
- [Примеры](#примеры)
- [Тестирование](#тестирование)
- [Установка](#установка)

## Описание

В данном проекте была разработана мини-модель искусственного интеллекта (ИИ), предназначенная для оказания помощи сотрудникам информационной безопасности. С учетом увеличения числа киберугроз, необходимость в эффективных инструментах анализа и реагирования становится все более актуальной. Проект направлен на автоматизацию процессов анализа сетевого трафика, проверки хешей файлов, анализа файлов на наличие вредоносного кода и выполнения сетевой безопасности.
Проект реализован на языке программирования Python, который является одним из самых популярных языков для разработки приложений в области машинного обучения и анализа данных благодаря своей простоте и мощным библиотекам.

## Библиотеки

*	**Transformers**: библиотека от Hugging Face, используемая для работы с предобученными языковыми моделями, такими как BERT и RoBERTa. Она позволяет легко интегрировать модели для обработки естественного языка (NLP).

*	**Pandas**: библиотека для работы с данными, предоставляющая удобные структуры данных и инструменты для анализа.

*	**Scikit-learn**: библиотека для машинного обучения, использующаяся для разделения данных на обучающие и тестовые наборы, а также для других операций, связанных с подготовкой данных.

* **Requests**: библиотека для выполнения HTTP-запросов, используемая для взаимодействия с внешними API, такими как VirusTotal и Shodan.

*	**Nmap**: инструмент для сетевого сканирования, используемый для анализа открытых портов и служб на целевых машинах.

*	**Shodan**: поисковая система для интернета вещей (IoT), позволяющая находить устройства и их уязвимости.

### В проекте используются два основных набора данных:

*	**Payload_data_CICIDS2017.csv**: этот набор данных содержит информацию о сетевом трафике, включая байты полезной нагрузки, TTL (Time to Live), общую длину пакета, протокол и метку (label), указывающую на тип трафика (например, нормальный или атакующий). Данные из этого набора используются для обучения модели, которая будет классифицировать сетевой трафик и выявлять потенциальные угрозы.


## Данные

### График данных базы
![График данных базы](info/img.png)

**Описание:**

График показывает зависимость между двумя характеристиками данных: total_len (общая длина пакета данных) и t_delta (время между двумя последовательными пакетами или временной интервал между событиями). Эти параметры могут быть использованы для анализа сетевого трафика или пакетов данных в контексте кибербезопасности, особенно в моделях для классификации типов трафика.

**Что показывает этот график:**

- **total_len:** Это показатель общей длины пакета данных, который может быть важным для анализа объема передаваемых данных за определенный промежуток времени. Это может быть полезным при выявлении аномального поведения в сети.

- **t_delta:** Это временной интервал между двумя событиями или пакетами данных. Этот параметр помогает анализировать скорость передачи данных или задержки между событиями.

На графике вы увидите, как изменение времени между пакетами (t_delta) связано с размером передаваемого пакета данных (total_len). Это может помочь выявить закономерности или аномалии в трафике, такие как пики в передаче данных или задержки, которые могут быть признаками атак или аномального поведения.

**Пример использования:**

- **Для анализа сетевого трафика:** Этот график может быть полезен для мониторинга и анализа нормального трафика и выявления аномальных паттернов, которые могут свидетельствовать о проблемах с сетью или атакующих действиях.

- **Для обучения модели:** Использование таких характеристик как **total_len** и **t_delta** может быть полезным при обучении модели для классификации различных типов сетевого трафика, таких как **BENIGN** или **ATTACK**.

### График оценки точности и ошибочности модели
![График оценки точности и ошибочности модели](info/model_analysis_report.png)

### График потерь (Loss Plot)

**Описание:**

График потерь отображает, как изменяются значения функции потерь (loss) на обучающей и валидационной выборке в процессе каждой эпохи обучения.

- **Потери (Training Loss)**: Это значения потерь на обучающей выборке. Снижение потерь указывает на то, что модель постепенно обучается и делает более точные прогнозы на обучающих данных.
- **Потери (Validation Loss)**: Это значения потерь на валидационной выборке. Эти данные помогают нам понять, насколько хорошо модель обобщает информацию на данных, которые она не видела в процессе обучения.

**Как читать график:**

- Если линия потерь на валидационной выборке продолжает снижаться, это указывает на улучшение производительности модели.
- Если линия на валидационной выборке начинает расти, возможно, происходит переобучение (overfitting), и модель теряет способность обобщать на новых данных.

### График точности (Accuracy Plot)

**Описание:**

График точности показывает, как меняется точность (accuracy) модели на обучающей и валидационной выборке в процессе каждой эпохи.

- **Точность (Training Accuracy)**: Это точность модели на обучающих данных. Обычно точность на обучающих данных растет с каждой эпохой, поскольку модель "учится" с каждым проходом.
- **Точность (Validation Accuracy)**: Это точность модели на валидационных данных, которые не использовались в процессе обучения. Этот показатель критичен для оценки способности модели обобщать и делать правильные предсказания на новых данных.

**Как читать график:**

- Если точность на обучающих данных растет, а на валидационных — стабилизируется или растет, это хороший показатель. Это означает, что модель не только обучается на обучающих данных, но и может обобщать на новых данных.
- Если точность на валидационных данных начинает снижаться, это может означать переобучение (overfitting).

### Итоговая производительность модели

В зависимости от того, как будут изменяться графики потерь и точности в процессе обучения, вы сможете оценить качество работы модели. Если на последних эпохах графики показывают стабильную или улучшающуюся точность на валидации и уменьшение потерь, модель будет работать хорошо.

При успешном обучении точность модели на тестовой выборке (например, 90-95%) должна быть высокой, что означает, что она сможет обрабатывать данные с высокой степенью надежности. Однако, если точность низкая (ниже 70%), это может свидетельствовать о необходимости дальнейшей настройки гиперпараметров модели или улучшения качества входных данных.


### График целостности данных
![График целостности данных](info/data_integrity_check.png)

#### График пропорции пропущенных данных (Proportion of Missing Data)

**Описание:**

Этот график отображает пропорцию пропущенных значений (NaN) в каждом из столбцов набора данных. Пропущенные данные могут существенно повлиять на точность модели машинного обучения, так как они могут искажать результаты или мешать обучению.

**Что показывает этот график:**

- **Пропорция пропущенных данных:** На графике отображается процент отсутствующих значений для каждого столбца данных. Это помогает визуализировать, какие признаки (столбцы) имеют много пропусков и могут потребовать предварительной обработки (например, иммутирования значений или удаления столбцов).
- **Распределение пропусков:** График показывает, насколько сильно одни столбцы страдают от отсутствующих данных, а другие могут быть полными.

#### График дублирования данных (Duplication Data)

**Описание:**

График показывает количество дублирующихся строк в наборе данных. Дублированные данные могут существенно повлиять на качество и стабильность модели, так как она может запомнить и переобучиться на этих избыточных данных.

**Что показывает этот график:**

- **Количество дубликатов:** На графике отображается, сколько строк в наборе данных являются точными дубликатами. Это поможет увидеть, если данные были случайно дублированы или загружены неправильно.
- **Распределение дубликатов:** График может также показывать, насколько сильно данные дублируются в зависимости от разных признаков или по всей выборке.

### Пример обучения модели

**Описание:**

Этот раздел выводит информацию о процессе обучения модели в консоли Bash. Во время обучения модель проходит через несколько эпох (iterations), и на каждом шаге отслеживаются ключевые метрики, такие как точность (accuracy) и ошибка (loss).

**Что показывает этот вывод:**

1. **Этапы обучения (epochs):**

   - **Каждая эпоха** — это один полный цикл через все обучающие данные. Обычно на каждой эпохе модель обновляет свои параметры (например, веса) в процессе оптимизации.
В выводе показывается номер текущей эпохи, например: Epoch 1/10, что означает, что это первая эпоха из 10.


2. **Точность (accuracy):**

    - Это процент правильных предсказаний модели на обучающих данных. Чем выше точность, тем лучше модель обучается на текущем наборе данных.
На каждой эпохе выводится текущая точность на обучающем наборе данных и на тестовом наборе данных.
Пример: Train Accuracy: 0.85 и Test Accuracy: 0.82 указывают, что модель достигает 85% точности на обучающей выборке и 82% на тестовой.

   
3. **Ошибки (loss):**

    - Это показатель, который измеряет, насколько сильно предсказания модели отличаются от реальных значений. Чем ниже ошибка, тем лучше модель предсказывает.
Ошибка может быть связана с конкретной функцией потерь, например, для задач классификации — это может быть кросс-энтропийная ошибка, а для задач регрессии — среднеквадратичная ошибка.
   - Пример: **Loss: 0.6943 указывает на текущий уровень ошибки модели.**


4. Прогресс обучения:

    - На каждой эпохе выводятся прогресс-бар и метрики, такие как точность и ошибка, что позволяет отслеживать улучшения модели по мере обучения.

    - **Пример вывода:**
```bash

Epoch 1/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 62s 2ms/step - accuracy: 0.4981 - loss: 0.6943 - val_accuracy: 0.4982 - val_loss: 0.6932
Epoch 2/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 39s 1ms/step - accuracy: 0.5002 - loss: 0.6932 - val_accuracy: 0.4982 - val_loss: 0.6932
Epoch 3/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 38s 1ms/step - accuracy: 0.5003 - loss: 0.6932 - val_accuracy: 0.5018 - val_loss: 0.6931
Epoch 4/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 42s 1ms/step - accuracy: 0.5012 - loss: 0.6932 - val_accuracy: 0.5018 - val_loss: 0.6931
Epoch 5/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 43s 1ms/step - accuracy: 0.4992 - loss: 0.6932 - val_accuracy: 0.4982 - val_loss: 0.6932
Epoch 6/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 46s 1ms/step - accuracy: 0.5011 - loss: 0.6932 - val_accuracy: 0.5018 - val_loss: 0.6932
Epoch 7/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 64s 2ms/step - accuracy: 0.5002 - loss: 0.6932 - val_accuracy: 0.4982 - val_loss: 0.6931
Epoch 8/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 58s 2ms/step - accuracy: 0.4994 - loss: 0.6932 - val_accuracy: 0.5018 - val_loss: 0.6931
Epoch 9/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 49s 2ms/step - accuracy: 0.4995 - loss: 0.6932 - val_accuracy: 0.4982 - val_loss: 0.6932
Epoch 10/10
32457/32457 ━━━━━━━━━━━━━━━━━━━━ 58s 2ms/step - accuracy: 0.5003 - loss: 0.6932 - val_accuracy: 0.4982 - val_loss: 0.6932
8115/8115 ━━━━━━━━━━━━━━━━━━━━ 8s 943us/step - accuracy: 0.4987 - loss: 0.6932
Точность на тестовой выборке: 49.82%

```

## Использование

### Интерактивный режим:

После запуска приложения вы перейдете в интерактивный режим, где сможете вводить команды.
Для получения справки по доступным командам введите help.
Доступные команды:

#### 1) question: Задать вопрос по безопасности.
Вводите вопрос, связанный с безопасностью, и получайте ответ от AI-консультанта по безопасности.

#### 2) file: Выполнить анализ файла.
Укажите путь к файлу, и программа выполнит его анализ, предоставляя результаты, такие как наличие вредоносного кода или уязвимостей.

#### 3) network: Провести анализ сети.
Вводите IP-адрес или доменное имя для проверки репутации сети и сканирования на уязвимости. Программа предоставит информацию о репутации и возможных уязвимостях.

#### 4) train: Обучить модель на основе предоставленного набора данных.
Укажите путь к набору данных, и программа обучит модель на основе предоставленных данных. Это может быть полезно для улучшения алгоритмов безопасности.
(Изначально программа имеет набор данных для обучения и может предоставить определенный вид реализации данного набора данных)

#### 5) exit: Выйти из приложения.

## Тестирование 

В файлах программы уже имеются набор тестов для проверки работы классов и их функций

## Установка

Инструкции по установке проекта. Например:
```bash
git clone https://github.com/David2287/Security_AI.git

pip install -r Security_AI/requirements.txt
```

```http request
https://clck.ru/3FGWHh
```
